# ğŸ“‹ ×¨×©×™××” ××œ××” ×©×œ ×›×œ ××” ×©×”××ª×¨ ×¢×•×©×” ×›×¨×’×¢

## ğŸ¯ ×¡×§×™×¨×” ×›×œ×œ×™×ª

××¢×¨×›×ª SaaS ××œ××” ×œ×”×–×× ×•×ª ×“×™×’×™×˜×œ×™×•×ª ×“×¨×š QR codes ×¢× AI assistant, × ×™×”×•×œ ×× ×•×™×™×, ×•×”×“×¤×¡×” ××•×˜×•××˜×™×ª.

---

## ğŸ—ï¸ ×ª×©×ª×™×ª ×˜×›× ×™×ª

### Frontend & Backend

- **Next.js 14** (App Router) + **React 18** + **TypeScript**
- **Tailwind CSS** ×œ×¢×™×¦×•×‘
- **Framer Motion** ×œ×× ×™××¦×™×•×ª
- **react-hot-toast** ×œ×”×ª×¨××•×ª UX

### ×‘×¡×™×¡ × ×ª×•× ×™×

- **Supabase (PostgreSQL)** - ×›×œ ×”× ×ª×•× ×™× × ×©××¨×™× ×‘-Supabase
- **4 ×˜×‘×œ××•×ª ×¢×™×§×¨×™×•×ª:**
  - `businesses` - ×¤×¨×˜×™ ×¢×¡×§×™×, ×× ×•×™×™×, ×”×’×“×¨×•×ª
  - `tables` - ×©×•×œ×—× ×•×ª ×•×§×•×“×™ QR
  - `menuItems` - ×¤×¨×™×˜×™ ×ª×¤×¨×™×˜
  - `orders` - ×”×–×× ×•×ª

### ××‘×˜×—×”

- **JWT** ×œ××™××•×ª ××©×ª××©×™×
- **Middleware** ××’×Ÿ ×¢×œ `/dashboard` ×•-`/super-admin`
- **Cookies** ×œ×©××™×¨×ª ×¡×©×Ÿ

---

## ğŸ‘¤ ×–×¨×™××ª ×‘×¢×œ ×”×¢×¡×§

### 1. ×¨×™×©×•× ×¢×¡×§ ×—×“×© (`/register`)

- ×˜×•×¤×¡ ×¨×™×©×•×:
  - ×©× ×¢×¡×§
  - ×¡×•×’ ×¢×¡×§ (×‘×¨/×¤×™×¦×¨×™×”/×¡×•×©×™/×›×œ×œ×™)
  - ×ª×‘× ×™×ª ×¢×™×¦×•×‘ (Bar/Pizza/Sushi/Generic)
  - ××™××™×™×œ ×•×¡×™×¡××”
- ×™×•×¦×¨ ×¢×¡×§ ×—×“×© ×¢×:
  - `businessId` ×™×™×—×•×“×™ (UUID)
  - ×× ×•×™ trial ×¢× 10 ×©×•×œ×—× ×•×ª
  - `isEnabled = true`

### 2. ×”×ª×—×‘×¨×•×ª (`/login`)

- ×˜×•×¤×¡ ×”×ª×—×‘×¨×•×ª ×¢× ××™××™×™×œ ×•×¡×™×¡××”
- ×‘×“×™×§×ª ×¡×™×¡××” ×¢× bcrypt
- ×™×¦×™×¨×ª JWT token ×•×©××™×¨×” ×‘×§×•×§×™
- ×”×¤× ×™×” ××•×˜×•××˜×™×ª ×œ×“×©×‘×•×¨×“

### 3. ×“×©×‘×•×¨×“ ×¢×¡×§ (`/dashboard`)

#### ×˜××‘ 1: × ×™×”×•×œ ×ª×¤×¨×™×˜

- **×”×•×¡×¤×ª/×¢×¨×™×›×ª ×× ×•×ª:**
  - ×§×˜×’×•×¨×™×”
  - ×©× ×× ×”
  - ××—×™×¨
  - URL ×ª××•× ×”
  - ××¨×›×™×‘×™× (××•×¤×¨×“×™× ×‘×¤×¡×™×§×™×)
  - ××œ×¨×’× ×™× (××•×¤×¨×“×™× ×‘×¤×¡×™×§×™×)
  - â­ **×× ×” ××•××œ×¦×ª** (checkbox) - ××•×¤×™×¢×” ×‘-carousel
  - ğŸ¤° **××ª××™× ×œ×”×¨×™×•×Ÿ** (checkbox) - ×ª×’ ××™×•×—×“ ×‘×ª×¤×¨×™×˜
- **×¨×©×™××ª ×× ×•×ª:**
  - ×ª×¦×•×’×” ××¡×•×“×¨×ª ×¢× ×ª××•× ×•×ª
  - ×›×¤×ª×•×¨ â­ ××”×™×¨ ×œ×”×¤×™×›×” ×œ××•××œ×¦×ª
  - ×›×¤×ª×•×¨ ×¢×¨×™×›×” ×•××—×™×§×”
  - ×ª×’ "â­ ××•××œ×¥" ×œ×× ×•×ª ××•××œ×¦×•×ª
- **API:**
  - `GET /api/menu` - ×˜×¢×™× ×ª ×× ×•×ª
  - `POST /api/menu` - ×™×¦×™×¨×ª ×× ×”
  - `PUT /api/menu/[menuItemId]` - ×¢×“×›×•×Ÿ ×× ×”
  - `DELETE /api/menu/[menuItemId]` - ××—×™×§×ª ×× ×”

#### ×˜××‘ 2: ×©×•×œ×—× ×•×ª ×•×§×•×“×™ QR

- **×”×•×¡×¤×ª ×©×•×œ×—×Ÿ:**
  - `tableId` - ××–×”×” ×˜×›× ×™ (×œ×œ× ×¨×•×•×—×™×)
  - `label` - ×©× ×©×”×œ×§×•×— ×¨×•××”
- **QR Code:**
  - ×™×¦×™×¨×” ××•×˜×•××˜×™×ª ×©×œ QR code
  - ×§×™×©×•×¨ ×™×©×™×¨: `/menu/[businessId]/[tableId]`
  - ××¤×©×¨×•×ª ×œ×”×•×¨×“×” ×•×”×“×¤×¡×”
- **×¨×©×™××ª ×©×•×œ×—× ×•×ª:**
  - ×ª×¦×•×’×” ×©×œ ×›×œ ×”×©×•×œ×—× ×•×ª
  - ×›×¤×ª×•×¨ "×¦×¤×” ×‘-QR" ×œ×›×œ ×©×•×œ×—×Ÿ
  - ×›×¤×ª×•×¨ ××—×™×§×”
- **API:**
  - `GET /api/tables` - ×˜×¢×™× ×ª ×©×•×œ×—× ×•×ª
  - `POST /api/tables` - ×™×¦×™×¨×ª ×©×•×œ×—×Ÿ
  - `DELETE /api/tables/[tableId]` - ××—×™×§×ª ×©×•×œ×—×Ÿ
- **×œ×•×’×™×§×ª ×× ×•×™:**
  - ×—×¡×™××ª ×”×•×¡×¤×ª ×©×•×œ×—× ×•×ª ×× `tables.length >= tablesAllowed`
  - ×”×•×“×¢×ª ×©×’×™××” ×‘×¨×•×¨×”

#### ×˜××‘ 3: ×”×’×“×¨×•×ª ×¢×¡×§

- **×¤×¨×˜×™ ×¢×¡×§:**
  - ×©× ×”×¢×¡×§
  - ×¡×•×’ ×¢×¡×§ (`type`)
  - ×ª×‘× ×™×ª ×¢×™×¦×•×‘ (`template`) - ××©×¤×™×¢ ×¢×œ Theme
- **ğŸ¤– ×”×•×¨××•×ª ××•×ª×××•×ª ×œ-AI:**
  - ×©×“×” ×˜×§×¡×˜ ××¨×•×š
  - ×××¤×©×¨ ×œ×¢×¡×§ ×œ×”×’×“×™×¨ ×”×•×¨××•×ª ×¡×¤×¦×™×¤×™×•×ª ×œ-AI
  - ×œ×“×•×’××”: "×‘×¡×•×©×™, ×× ×•×ª X ×•-Y ×—×™×™×‘×•×ª ×œ×”×™×•×ª ××¤×•×™×•×ª, ×œ× × ×"
- **×¡×˜×˜×•×¡ ×× ×•×™:**
  - ×ª×¦×•×’×ª ×¡×˜×˜×•×¡ (trial/active/expired/past_due)
  - ××¡×¤×¨ ×©×•×œ×—× ×•×ª ×‘×©×™××•×© / ××•×ª×¨
  - ×ª××¨×™×š ×—×™×•×‘ ×”×‘×
  - ×›×¤×ª×•×¨ "×©×“×¨×’ / ×—×“×© ×× ×•×™" â†’ ××¢×‘×¨ ×œ-Stripe Checkout
- **API:**
  - `GET /api/business/info` - ×˜×¢×™× ×ª ×¤×¨×˜×™ ×¢×¡×§
  - `PUT /api/business/update` - ×¢×“×›×•×Ÿ ×¤×¨×˜×™ ×¢×¡×§

#### ×˜××‘ 4: ×”×’×“×¨×•×ª ××“×¤×¡×ª / BON

- **×”×’×“×¨×•×ª ××“×¤×¡×ª:**
  - Enable/Disable ××“×¤×¡×ª
  - ×¡×•×’ ×—×™×‘×•×¨: HTTP/HTTPS, TCP, Serial
  - Endpoint (URL/IP)
  - Port (×œ-TCP/Serial)
  - Payload Type: JSON, Text, XML
  - Headers ××•×ª×××™× ××™×©×™×ª (×œ-HTTP)
- **×‘×“×™×§×ª ××“×¤×¡×ª:**
  - ×›×¤×ª×•×¨ "×‘×“×•×§ ××“×¤×¡×ª" - ×©×•×œ×— ×”×–×× ×ª ×‘×“×™×§×”
  - ×”×•×“×¢×ª ×”×¦×œ×—×”/×©×’×™××”
- **API:**
  - `PUT /api/business/printer-config` - ×©××™×¨×ª ×”×’×“×¨×•×ª
  - `POST /api/printer/test` - ×‘×“×™×§×ª ××“×¤×¡×ª

#### ×˜××‘ 5: ×”×–×× ×•×ª ×•×¨×•×•×—×™×

- **×˜×‘×œ×ª ×”×–×× ×•×ª:**
  - ×›×œ ×”×”×–×× ×•×ª ×©×œ ×”×¢×¡×§
  - ××™×“×¢: ×©×•×œ×—×Ÿ, ×¡×›×•×, ×¡×˜×˜×•×¡, ×ª××¨×™×š
  - ×¡×™×›×•× AI (×× ×§×™×™×)
- **×¡×™×›×•××™ ×¨×•×•×—×™×:**
  - ×¨×•×•×—×™× ×”×™×•×
  - ×¨×•×•×—×™× ×”×©×‘×•×¢
  - ×¨×•×•×—×™× ×”×—×•×“×©
- **API:**
  - `GET /api/orders/list` - ×¨×©×™××ª ×”×–×× ×•×ª
  - `GET /api/orders/stats` - ×¡×˜×˜×™×¡×˜×™×§×•×ª ×¨×•×•×—×™×

---

## ğŸ›’ ×–×¨×™××ª ×œ×§×•×—

### 1. ×ª×¤×¨×™×˜ ×œ×§×•×— (`/menu/[businessId]/[tableId]`)

#### ×ª×¦×•×’×” ×¨××©×™×ª (×›×©-`activeCategory === 'all'`)

- **Hero Section:**
  - Carousel "××‘×¦×¢×™× ×•×“×™×œ×™× ××•××œ×¦×™×" - ×× ×•×ª ×¢× `isFeatured = true`
  - Auto-rotate ×›×œ 4 ×©× ×™×•×ª
  - ×ª××•× ×” ×’×“×•×œ×”, ×©×, ××¨×›×™×‘×™×, ××—×™×¨
  - ×›×¤×ª×•×¨ "×”×•×¡×£ ×œ×¢×’×œ×”"
  - ×§×˜×’×•×¨×™×•×ª ×‘×¦×“ ×™××™×Ÿ (×“×¡×§×˜×•×¤) ××• ×‘×—×œ×§ ×”×¢×œ×™×•×Ÿ (××•×‘×™×™×œ)
- **×§×˜×’×•×¨×™×•×ª:**
  - **××•×‘×™×™×œ:** Sticky ×‘×—×œ×§ ×”×¢×œ×™×•×Ÿ, ×’×œ×™×œ×” ××•×¤×§×™×ª
  - **×“×¡×§×˜×•×¤:** Sidebar ××™××™×Ÿ, sticky
  - ×›×¤×ª×•×¨ "×”×›×œ" + ×›×œ ×”×§×˜×’×•×¨×™×•×ª

#### ×ª×¦×•×’×ª ×§×˜×’×•×¨×™×” (×›×©-`activeCategory !== 'all'`)

- **Carousel ×§×•××¤×§×˜×™** ×‘×¨××© (×× ×™×© ×× ×•×ª ××•××œ×¦×•×ª)
- **×¨×©×™××ª ×× ×•×ª:**
  - ×›×¨×˜×™×¡×™ ×× ×•×ª ××¡×•×“×¨×™×
  - ×ª××•× ×”, ×©×, ×§×˜×’×•×¨×™×”, ××—×™×¨
  - ××¨×›×™×‘×™× ×•××œ×¨×’× ×™×
  - ×ª×’ "â­ ××•××œ×¥" ×œ×× ×•×ª ××•××œ×¦×•×ª
  - ×ª×’ "ğŸ¤° ××ª××™× ×œ×”×¨×™×•×Ÿ" ×œ×× ×•×ª ××ª××™××•×ª
  - ×›×¤×ª×•×¨ "×”×•×¡×£ ×œ×¢×’×œ×”"

#### ×”×¨×—×‘×ª ×× ×•×ª (Expanded View)

- **×œ×—×™×¦×” ×¢×œ ×× ×”:**
  - **××•×‘×™×™×œ:** ×ª×¦×•×’×” ×›××¢×˜ ××œ××”, optimized ×œ×™×“ ××—×ª
  - **×“×¡×§×˜×•×¤:** ×”×¨×—×‘×” ×‘××§×•×, ×‘×ª×•×š ×”×¤×¨×™×¡×”
- **×ª×•×›×Ÿ ××•×¨×—×‘:**
  - ×ª××•× ×” ×’×“×•×œ×” ×™×•×ª×¨
  - ×ª×™××•×¨ ××œ× (××¨×›×™×‘×™×, ××œ×¨×’× ×™×)
  - ×ª×’ "××ª××™× ×œ×”×¨×™×•×Ÿ" ×× ×¨×œ×•×•× ×˜×™
  - ×›×¤×ª×•×¨ "×”×•×¡×£ ×œ×¢×’×œ×”" ×‘×•×œ×˜
- **×¡×’×™×¨×”:**
  - ×›×¤×ª×•×¨ X
  - ×œ×—×™×¦×” ××—×•×¥ ×œ×›×¨×˜×™×¡ (××•×‘×™×™×œ)
  - ×”×—×œ×§×” ×œ××˜×” (××•×‘×™×™×œ)
  - ×©××™×¨×ª ××™×§×•× ×’×œ×™×œ×”

#### ×¢×’×œ×” (Cart)

- **×ª×—×ª×™×ª ×§×‘×•×¢×”:**
  - ×¡×™×›×•× ×›××•×ª ×¤×¨×™×˜×™×
  - ×¡×›×•× ×›×•×œ×œ
  - ×›×¤×ª×•×¨ "×¡×•×’×¨×™× ×”×–×× ×” ×¢× ×”×¢×•×–×¨ ×”×—×›× â€“ ×©××œ×•×ª, ×©×™× ×•×™×™× ×•××” ×©×‘× ×œ×›× â†’"
- **CartContext:**
  - × ×™×”×•×œ ×’×œ×•×‘×œ×™ ×©×œ ×”×¢×’×œ×”
  - ×¤×•× ×§×¦×™×•×ª: `addItem`, `removeItem`, `clearCart`

#### Theme System

- **4 ×ª××•×ª ×× ×™××˜×™×‘×™×•×ª:**
  - **Bar Theme:** ×× ×™××¦×™×•×ª ×‘×™×¨×”, ×—×œ×§×™×§×™×
  - **Pizza Theme:** ×× ×™××¦×™×•×ª ×¤×™×¦×”, ×’×œ×™×
  - **Sushi Theme:** ×× ×™××¦×™×•×ª ×¡×•×©×™, ×“×’×™×
  - **Generic Theme:** ×× ×™××¦×™×•×ª ×›×œ×œ×™×•×ª, ×—×œ×§×™×§×™×
- **ThemeWrapper** ×‘×•×—×¨ ××ª ×”×ª××” ×œ×¤×™ `business.template`

#### ×œ×•×’×™×§×ª ×× ×•×™

- **×‘×“×™×§×ª ×ª×•×§×£:**
  - `GET /api/menu/info` ×‘×•×“×§ ×¡×˜×˜×•×¡ ×× ×•×™
  - ×× `isEnabled = false` â†’ 403 "Business is disabled"
  - ×× `subscription.status = 'expired'` ××• `'past_due'` â†’ 403 "Subscription expired"
- **×”×•×“×¢×ª ××–×”×¨×”:**
  - ×‘×× ×¨ ××“×•× ×‘×•×œ×˜ ×‘×ª×¤×¨×™×˜
  - "×”×× ×•×™ ×¤×’ ×ª×•×§×£" / "×”×—×©×‘×•×Ÿ ××™× ×• ×¤×¢×™×œ"
  - ×—×¡×™××ª ×”×•×¡×¤×” ×œ×¢×’×œ×”
  - ×”×•×“×¢×”: "×”×ª×¤×¨×™×˜ ××•×¦×’ ×œ×¦×¤×™×™×” ×‘×œ×‘×“"

### 2. ×¦'××˜ AI (`/menu/[businessId]/[tableId]/chat`)

#### ×××©×§ ×¦'××˜

- **×”×•×“×¢×•×ª:**
  - ×ª×¦×•×’×ª ×”×™×¡×˜×•×¨×™×™×ª ×©×™×—×”
  - ×”×•×“×¢×•×ª ××©×ª××© (××™××™×Ÿ)
  - ×”×•×“×¢×•×ª AI (××©×××œ)
- **×§×œ×˜:**
  - ×©×“×” ×˜×§×¡×˜ ×œ×”×§×œ×“×ª ×©××œ×•×ª
  - ×›×¤×ª×•×¨ ×©×œ×™×—×”
- **×¡×˜×˜×•×¡:**
  - Loading state ×‘×¢×ª ×©×œ×™×—×”
  - ×”×•×“×¢×•×ª ×©×’×™××” ×× ×™×© ×‘×¢×™×”

#### ×¤×•× ×§×¦×™×•× ×œ×™×•×ª AI

- **×˜×¢×™× ×ª × ×ª×•× ×™×:**
  - `aiInstructions` ×©×œ ×”×¢×¡×§
  - ×›×œ ×¤×¨×™×˜×™ ×”×ª×¤×¨×™×˜ (×›×•×œ×œ `isPregnancySafe`)
  - ×”×¢×’×œ×” ×”× ×•×›×—×™×ª
- **System Prompt:**
  - ×¢×•×‘×“×”: ×œ× ×œ×”××¦×™× ×× ×•×ª
  - ×¢×–×¨×” ×¢× ××œ×¨×’×™×•×ª, ××¨×›×™×‘×™×, ×¡×•×›×¨, ×’×œ×•×˜×Ÿ
  - ×¢×–×¨×” ×‘×”×¨×™×•×Ÿ - ××©×ª××© ×‘-`isPregnancySafe` ×•×”×•×¨××•×ª ×”×¢×¡×§
  - ×¡×™×›×•× ×”×–×× ×” ×œ×¤× ×™ ××™×©×•×¨
  - ×”×•×¨××•×ª ××•×ª×××•×ª ××”×¢×¡×§
- **Actions JSON:**
  - AI ×™×›×•×œ ×œ×©×œ×•×— `ACTIONS_JSON` ×¢×:
    - `add_to_cart` - ×”×•×¡×¤×ª ×× ×” ×œ×¢×’×œ×”
    - `remove_from_cart` - ×”×¡×¨×ª ×× ×” ××”×¢×’×œ×”
  - ×”×•×“×¢×ª ××™×©×•×¨ ××•×˜×•××˜×™×ª ××—×¨×™ ×¤×¢×•×œ×”

#### ××™×©×•×¨ ×”×–×× ×”

- **×›×¤×ª×•×¨ "Confirm Order":**
  - ××•×¤×™×¢ ×›×©×”×–×× ×” ××•×›× ×”
  - ×©×•×œ×— `POST /api/orders`
- **×™×¦×™×¨×ª ×”×–×× ×”:**
  - ×—×™×©×•×‘ `totalAmount`
  - ×™×¦×™×¨×ª `orderId` (UUID)
  - ×©××™×¨×” ×‘-`orders` ×¢×:
    - `businessId`, `tableId`
    - `items` (JSON)
    - `aiSummary` (×× ×§×™×™×)
    - `status = 'received'`
- **××—×¨×™ ××™×©×•×¨:**
  - × ×™×§×•×™ ×”×¢×’×œ×”
  - ×”×•×“×¢×ª ×”×¦×œ×—×” ×¢× ××–×”×” ×”×–×× ×”
  - ××¤×©×¨×•×ª ×œ×”×ª×—×™×œ ×”×–×× ×” ×—×“×©×”

---

## ğŸ‘¨â€ğŸ’¼ ×¡×•×¤×¨ ××“××™×Ÿ (`/super-admin`)

### 1. ×¡×§×™×¨×” ×›×œ×œ×™×ª

- **×¡×˜×˜×™×¡×˜×™×§×•×ª:**
  - ×¡×š ×›×œ ×”×¢×¡×§×™×
  - ×¢×¡×§×™× ×¤×¢×™×œ×™×
  - ×¡×š ×›×œ ×”×”×–×× ×•×ª
  - ×”×–×× ×•×ª ×”×™×•×
  - ×¡×š ×›×œ ×”×”×›× ×¡×•×ª
  - ×¡×š ×›×œ ×”×©×•×œ×—× ×•×ª
- **API:** `GET /api/super-admin/stats`

### 2. × ×™×”×•×œ ×¢×¡×§×™×

- **×˜×‘×œ×ª ×¢×¡×§×™×:**
  - ×©× ×¢×¡×§, ××™××™×™×œ, ×¡×•×’
  - ××¡×¤×¨ ×©×•×œ×—× ×•×ª (`tablesCount`)
  - ××¡×¤×¨ ×”×–×× ×•×ª (`ordersCount`)
  - ×¡×˜×˜×•×¡ ×¢×¡×§ (×¤×¢×™×œ/××•×©×‘×ª)
  - ×¡×˜×˜×•×¡ ×× ×•×™ (trial/active/expired/past_due)
  - ×”×•×¨××•×ª AI (×× ×§×™×™××•×ª)
- **×¤×¢×•×œ×•×ª:**
  - ×›×¤×ª×•×¨ "×”×©×‘×ª/×”×¤×¢×œ" â†’ ××¢×“×›×Ÿ `isEnabled`
  - Dropdown ×¡×˜×˜×•×¡ ×× ×•×™ â†’ ××¢×“×›×Ÿ `subscription.status`
  - ×©×“×” ××¡×¤×¨ ×©×•×œ×—× ×•×ª â†’ ××¢×“×›×Ÿ `subscription.tablesAllowed`
- **API:**
  - `GET /api/super-admin/businesses` - ×¨×©×™××ª ×¢×¡×§×™×
  - `PUT /api/super-admin/businesses/[businessId]` - ×¢×“×›×•×Ÿ ×¢×¡×§

### 3. ×ª××—×•×¨

- **×”×’×“×¨×ª ××—×™×¨:**
  - ×©×“×” `pricePerTable` (50â‚ª ×œ×—×•×“×© ×œ×›×œ ×©×•×œ×—×Ÿ)
  - ×—×™×©×•×‘ ×“×•×’×××•×ª (5/10/20 ×©×•×œ×—× ×•×ª)
- **×¢×“×›×•×Ÿ ×©×•×œ×—× ×•×ª:**
  - ×©×“×” ××¡×¤×¨×™ ×œ×›×œ ×¢×¡×§
  - On blur â†’ ×¢×“×›×•×Ÿ `subscription.tablesAllowed`

---

## ğŸ’³ ×ª×©×œ×•××™× (Stripe) - ×—×œ×§×™

### ××” ×™×©:

- **API Route:** `/api/billing/create-checkout-session`
- **×™×¦×™×¨×ª Checkout Session:**
  - ××§×‘×œ `businessId` ×•-`tablesRequested`
  - ××—×©×‘ ××—×™×¨: `tablesRequested * 50 ILS`
  - ×™×•×¦×¨ Stripe Checkout Session
  - ××—×–×™×¨ URL ×œ×”×¤× ×™×”
- **×›×¤×ª×•×¨ ×‘×“×©×‘×•×¨×“:**
  - "×©×“×¨×’ / ×—×“×© ×× ×•×™"
  - ××¢×‘×¨ ×œ-Stripe Checkout

### ××” ×—×¡×¨:

- Webhooks ×œ×¢×“×›×•×Ÿ `subscription.status` ××•×˜×•××˜×™×ª
- ×¢×“×›×•×Ÿ `nextBillingDate` ××•×˜×•××˜×™×ª
- ×—×™×©×•×‘ ××—×™×¨ ×“×™× ××™ ×œ×¤×™ `pricePerTable`

---

## ğŸ¨ ×ª×›×•× ×•×ª UX ××ª×§×“××•×ª

### 1. ×”×ª×¨××•×ª (Toasts)

- **react-hot-toast** ×œ×”×ª×¨××•×ª
- **×”×ª×¨××•×ª ×‘××§×•××•×ª:**
  - ×”×¢×ª×§×ª ×§×™×©×•×¨ QR
  - ×¢×“×›×•×Ÿ ×¤×¨×˜×™ ×¢×¡×§
  - ×¢×“×›×•×Ÿ ×”×’×“×¨×•×ª ××“×¤×¡×ª
  - ×”×•×¡×¤×”/××—×™×§×ª ×× ×”
  - ×”×•×¡×¤×”/××—×™×§×ª ×©×•×œ×—×Ÿ
  - ×”×•×¡×¤×” ×œ×¢×’×œ×”
  - ×¤×¢×•×œ×•×ª AI (×”×•×¡×¤×”/×”×¡×¨×” ××”×¢×’×œ×”)

### 2. ×× ×™××¦×™×•×ª

- **Framer Motion** ×‘×›×œ ××§×•×:
  - ××¢×‘×¨×™ ×“×¤×™×
  - ×›×¨×˜×™×¡×™ ×× ×•×ª
  - Carousel
  - ×”×¨×—×‘×ª ×× ×•×ª
  - ×›×¤×ª×•×¨×™×

### 3. Responsive Design

- **××•×‘×™×™×œ:**
  - ×§×˜×’×•×¨×™×•×ª sticky ×‘×—×œ×§ ×”×¢×œ×™×•×Ÿ
  - ×’×œ×™×œ×” ××•×¤×§×™×ª ×œ×§×˜×’×•×¨×™×•×ª
  - ×ª×¦×•×’×” ××•×¨×—×‘×ª ×›××¢×˜ ××œ××”
  - ×ª×¤×¨×™×˜ ××•×ª×× ×œ××’×¢
- **×“×¡×§×˜×•×¤:**
  - Grid layout
  - Sidebar ×§×˜×’×•×¨×™×•×ª
  - ×”×¨×—×‘×” ×‘××§×•×
  - ×ª×¦×•×’×” ××™×˜×‘×™×ª

---

## ğŸ”’ ××‘×˜×—×” ×•×œ×•×’×™×§×”

### 1. ××™××•×ª

- **JWT Tokens:**
  - ×™×¦×™×¨×” ×‘-`/api/auth/login`
  - ×‘×“×™×§×” ×‘-`middleware.ts`
  - ×©××™×¨×” ×‘×§×•×§×™ `auth`
- **Route Protection:**
  - `/dashboard/*` - ×“×•×¨×© ××™××•×ª
  - `/super-admin` - ×“×•×¨×© ××™××•×ª (TODO: ×‘×“×™×§×ª role)

### 2. ×‘×“×™×§×•×ª ×× ×•×™

- **×‘-API:**
  - `GET /api/menu/info` - ×‘×•×“×§ `isEnabled` ×•-`subscription.status`
  - ××—×–×™×¨ 403 ×× ×œ× ×ª×§×™×Ÿ
- **×‘×ª×¤×¨×™×˜ ×œ×§×•×—:**
  - ×—×¡×™××ª ×”×•×¡×¤×” ×œ×¢×’×œ×”
  - ×”×•×“×¢×ª ××–×”×¨×” ×‘×•×œ×˜×ª

### 3. ×”×’×‘×œ×•×ª ×©×•×œ×—× ×•×ª

- **×‘×“×©×‘×•×¨×“:**
  - ×‘×“×™×§×”: `tables.length >= tablesAllowed`
  - ×—×¡×™××ª ×”×•×¡×¤×ª ×©×•×œ×—× ×•×ª ×× ×”×’×¢×” ×œ××’×‘×œ×”
  - ×”×•×“×¢×ª ×©×’×™××” ×‘×¨×•×¨×”

---

## ğŸ“Š API Routes ××œ××™×

### Business

- `GET /api/business/info` - ×¤×¨×˜×™ ×¢×¡×§
- `PUT /api/business/update` - ×¢×“×›×•×Ÿ ×¢×¡×§
- `POST /api/business/register` - ×¨×™×©×•× ×¢×¡×§
- `PUT /api/business/printer-config` - ×”×’×“×¨×•×ª ××“×¤×¡×ª

### Menu

- `GET /api/menu` - ×¨×©×™××ª ×× ×•×ª
- `POST /api/menu` - ×™×¦×™×¨×ª ×× ×”
- `GET /api/menu/info` - ×¤×¨×˜×™ ×¢×¡×§ (×œ×ª×¤×¨×™×˜)
- `PUT /api/menu/[menuItemId]` - ×¢×“×›×•×Ÿ ×× ×”
- `DELETE /api/menu/[menuItemId]` - ××—×™×§×ª ×× ×”

### Tables

- `GET /api/tables` - ×¨×©×™××ª ×©×•×œ×—× ×•×ª
- `POST /api/tables` - ×™×¦×™×¨×ª ×©×•×œ×—×Ÿ
- `DELETE /api/tables/[tableId]` - ××—×™×§×ª ×©×•×œ×—×Ÿ

### Orders

- `GET /api/orders/list` - ×¨×©×™××ª ×”×–×× ×•×ª
- `GET /api/orders/stats` - ×¡×˜×˜×™×¡×˜×™×§×•×ª ×¨×•×•×—×™×
- `POST /api/orders` - ×™×¦×™×¨×ª ×”×–×× ×”

### AI

- `POST /api/ai/chat` - ×¦'××˜ ×¢× AI

### Auth

- `POST /api/auth/login` - ×”×ª×—×‘×¨×•×ª
- `GET /api/auth/me` - ×¤×¨×˜×™ ××©×ª××© × ×•×›×—×™

### Printer

- `POST /api/printer/test` - ×‘×“×™×§×ª ××“×¤×¡×ª

### Billing

- `POST /api/billing/create-checkout-session` - ×™×¦×™×¨×ª Stripe Checkout

### Super Admin

- `GET /api/super-admin/stats` - ×¡×˜×˜×™×¡×˜×™×§×•×ª ×›×œ×œ×™×•×ª
- `GET /api/super-admin/businesses` - ×¨×©×™××ª ×¢×¡×§×™×
- `PUT /api/super-admin/businesses/[businessId]` - ×¢×“×›×•×Ÿ ×¢×¡×§

---

## ğŸ—„ï¸ ××‘× ×” ×‘×¡×™×¡ ×”× ×ª×•× ×™×

### Table: `businesses`

- `businessId` (TEXT, UNIQUE)
- `name`, `type`, `template`
- `email` (UNIQUE), `passwordHash`
- `isEnabled` (BOOLEAN)
- `subscription` (JSONB) - `{status, tablesAllowed, nextBillingDate}`
- `printerConfig` (JSONB) - ×”×’×“×¨×•×ª ××“×¤×¡×ª
- `aiInstructions` (TEXT) - ×”×•×¨××•×ª ×œ-AI
- `createdAt` (TIMESTAMPTZ)

### Table: `tables`

- `businessId` (TEXT, FK)
- `tableId` (TEXT)
- `label` (TEXT)
- UNIQUE(`businessId`, `tableId`)

### Table: `menuItems`

- `businessId` (TEXT, FK)
- `category` (TEXT)
- `name` (TEXT)
- `price` (NUMERIC)
- `imageUrl` (TEXT, nullable)
- `ingredients` (JSONB) - array
- `allergens` (JSONB) - array
- `is_featured` (BOOLEAN) - ×× ×” ××•××œ×¦×ª
- `is_pregnancy_safe` (BOOLEAN) - ××ª××™× ×œ×”×¨×™×•×Ÿ
- UNIQUE(`businessId`, `name`)

### Table: `orders`

- `orderId` (TEXT, UNIQUE)
- `businessId` (TEXT, FK)
- `tableId` (TEXT)
- `items` (JSONB) - array of items
- `aiSummary` (TEXT, nullable)
- `status` (TEXT) - 'received', 'sent_to_printer', 'printed', 'printer_error'
- `totalAmount` (NUMERIC)
- `createdAt` (TIMESTAMPTZ)

---

## âœ… ××” ×¢×•×‘×“ ×‘×¤×•×¢×œ

1. âœ… ×¨×™×©×•× ×¢×¡×§ ×—×“×© + ×”×ª×—×‘×¨×•×ª
2. âœ… ××™××•×ª ×¢× JWT ×•×§×•×§×™
3. âœ… ×“×©×‘×•×¨×“ ×¢×¡×§ ××œ×:
   - × ×™×”×•×œ ×ª×¤×¨×™×˜ (CRUD + ×× ×•×ª ××•××œ×¦×•×ª + ××ª××™× ×œ×”×¨×™×•×Ÿ)
   - × ×™×”×•×œ ×©×•×œ×—× ×•×ª ×•×§×•×“×™ QR
   - ×”×’×“×¨×•×ª ×¢×¡×§ (×›×•×œ×œ ×”×•×¨××•×ª AI)
   - ×”×’×“×¨×•×ª ××“×¤×¡×ª (UI + API)
   - ×¦×¤×™×™×” ×‘×”×–×× ×•×ª ×•×¨×•×•×—×™×
4. âœ… ×ª×¤×¨×™×˜ ×œ×§×•×— ××œ×:
   - ×ª×¤×¨×™×˜ ×“×™× ××™ ×¢× ×ª××•×ª ×× ×™××˜×™×‘×™×•×ª
   - Carousel ×× ×•×ª ××•××œ×¦×•×ª
   - ×§×˜×’×•×¨×™×•×ª (sticky ×‘××•×‘×™×™×œ, sidebar ×‘×“×¡×§×˜×•×¤)
   - ×”×¨×—×‘×ª ×× ×•×ª ×‘××§×•×
   - ×¢×’×œ×” + ×¡×™×›×•×
   - ×”×•×“×¢×ª ×× ×•×™ ×¤×’ ×ª×•×§×£
5. âœ… ×¦'××˜ AI ××œ×:
   - ×¢×•×‘×“ end-to-end ×¢× OpenAI
   - ×¨×•××” ×ª×¤×¨×™×˜ + ×”×•×¨××•×ª ××•×ª×××•×ª
   - ×¢×•×–×¨ ×¢× ××œ×¨×’×™×•×ª, ×”×¨×™×•×Ÿ, ×”×ª×××•×ª
   - ×™×›×•×œ ×œ×”×•×¡×™×£/×œ×”×¡×™×¨ ××”×¢×’×œ×”
   - ×™×•×¦×¨ ×”×–×× ×” ×•×©×•××¨ ×‘-Supabase
6. âœ… ×¡×•×¤×¨ ××“××™×Ÿ:
   - ×¡×˜×˜×™×¡×˜×™×§×•×ª ×›×œ×œ×™×•×ª
   - × ×™×”×•×œ ×¢×¡×§×™×
   - ×¢×“×›×•×Ÿ ×¡×˜×˜×•×¡ ×× ×•×™ ×•×©×•×œ×—× ×•×ª
7. âœ… UX ××ª×§×“×:
   - Toasts ×œ×”×ª×¨××•×ª
   - ×× ×™××¦×™×•×ª ×—×œ×§×•×ª
   - Responsive design ××œ×

---

## ğŸš§ ××” ×¢×“×™×™×Ÿ ×—×¡×¨ / ×—×œ×§×™

1. **Stripe Webhooks** - ×¢×“×›×•×Ÿ ×× ×•×™ ××•×˜×•××˜×™ ××—×¨×™ ×ª×©×œ×•×
2. **××™× ×˜×’×¨×¦×™×™×ª ××“×¤×¡×ª ×××™×ª×™×ª** - ×©×œ×™×—×” ××•×˜×•××˜×™×ª ×œ××“×¤×¡×ª ××—×¨×™ ×”×–×× ×”
3. **×”×ª×¨××•×ª** - ××™××™×™×œ/WhatsApp ×¢×œ ×”×–×× ×•×ª ×—×“×©×•×ª
4. **×“×•×—×•×ª ××ª×§×“××™×** - Export ×œ-CSV, ×’×¨×¤×™×
5. **×“×£ Subscription Expired** - ×¢××•×“ ×™×™×¢×•×“×™ ×™×¤×”

---

**×¡×™×›×•×:** ×”××¢×¨×›×ª ×”×™× ×¤×œ×˜×¤×•×¨××” ××œ××” ×•×¤×•× ×§×¦×™×•× ×œ×™×ª ×œ×”×–×× ×•×ª ×“×™×’×™×˜×œ×™×•×ª ×¢× AI, × ×™×”×•×œ ×× ×•×™×™×, ×•×”×“×¤×¡×”. ×¨×•×‘ ×”×ª×›×•× ×•×ª ×¢×•×‘×“×•×ª, ×•× ×•×ª×¨×• ×‘×¢×™×§×¨ ×©×™×¤×•×¨×™ UX ×•××™× ×˜×’×¨×¦×™×•×ª ×—×™×¦×•× ×™×•×ª.



